%!TEX TS-program = XeLaTeX
\documentclass[12pt]{article}
\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}

%%%
%% Needed for fonts in xelatex to work
%%%
% NOTE: I actually use XeLaTeX, which allows me to get the fonts
% exactly the way that I want them. For proposals, this means
% I can use Times New Roman instead of the default Computer
% Modern. I actually like Computer Modern, but since Times New
% Roman is standard, there's no point in throwing off a reviewer
% with an unexpected font, particularly one with such a
% polarizing reaction in readers. New upset the reviewrers, I
% always say.
%
% What's the point of this bit of rambling? If you do not want to use
% XeLaTeX and would rather stick to good old LaTeX, then you
% need to comment out the next few lines of font packages and
% font commands.
%
% If you want to use XeLaTeX but want different fonts, then you
% just need to change the name in the argument for \setmainfont
% and \setsansfont. Make sure that the font you use is loaded on
% your machine and your TeX distribution knows how to find it.
% See Google if you need to learn more about this.
%
%\usepackage{fontspec}
%\usepackage{xunicode}
%\setmainfont[Mapping=tex-text]{Times New Roman}
%\setsansfont[Mapping=tex-text,Color=000]{Ariel}


%%%
%% Packages that I use on a regular basis.
%%%
% Of course, you are likely to need some math typesetting so these
% three packages have you covered.
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{latexsym}
% I use color, graphicx, and epstopdf to read in PDFs for my figures.
\usepackage{color}
\usepackage{graphicx}
\usepackage{epstopdf}
% I don't remember why threeparttable and setspace is here. Inertia.
\usepackage{threeparttable}
\usepackage{setspace}
%%%
%% Some packages to handle the figures and captions
%%%
\usepackage[labelfont=bf]{caption}
\usepackage{subcaption}
\usepackage{wrapfig}

%%%
%% Packages and settings for my bibliography.
%%%
% apa_with_doi is a style I created to keep DOI in the bibliography
% but strip out URLs. There are a lot of other styles you can
% find for natbib. Again, Google is your friend.
% Author name and year references, i.e., Author (year):
%\usepackage{natbib}
%\bibliographystyle{apa_with_doi}
% Numbered references:
\usepackage[numbers,super]{natbib}
\bibliographystyle{unsrtnat}


%%%
%% Packages and commands to build my table of contents (TOC).
%%%
%% The trick was getting the References included properly.
%% Also, some of my table of contents entry have no page number
%% because those pages are generated separately by my institute.
%% Nothing to be done about that. You may or may not have the
%% same problem, so you may or may not have to tweak this.
\usepackage[nottoc,numbib]{tocbibind}
\renewcommand{\tocbibname}{References}
\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

%%%
%% These commands get the spacing around the title and section titles right.
%%%
% I tightened up the spacing. The LaTeX default is just too roomy.
% This spacing is still clean and legible, just not so free with the
% whitespace between sections.
%
% First the title.
\usepackage{titling}
\setlength{\droptitle}{-50pt}
\pretitle{\begin{center}\Large\bfseries\vspace{0ex}}%
\posttitle{\end{center}\Large\vspace{-2ex}}%
\preauthor{\begin{center}\large}%
\postauthor{\end{center}\large\vspace{-3ex}}%
\predate{\begin{center}\large}%q
\postdate{\end{center}\large\vspace{-6ex}}%
% Now the section headings.
\usepackage[noindentafter]{titlesec}
\titleformat{\section}{\large\bfseries}{\thesection}{1em}{}
\titlespacing{\section}{0pt}{18pt plus 2pt minus 2pt}{4pt plus 2pt minus 2pt}[0pt]
\titlespacing{\subsection}{0pt}{16pt plus 2pt minus 2pt}{4pt plus 2pt minus 2pt}[0pt]
\titlespacing{\subsubsection}{0pt}{14pt plus 2pt minus 2pt}{4pt plus 2pt minus 2pt}[0pt]

%%%
%% These commands get the lists to work the way that I want therm to.
%%%
% i.e. I want less space wrapping around the list.
\usepackage{enumitem}
\setlist{nolistsep}
\setlist[2]{noitemsep}
\setlist[1]{noitemsep}

%%%
%% Commands for making the tables.
%%%
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{array}

%%%
%%% Package to create Gantt schedules
%%%
\usepackage{pgfgantt}


%%%
%%% Formatting urls
%%%
\usepackage{url}
\urlstyle{rm}


%%%
%% A few new commands to handle some frequently used symbols.
%%%
% I work with temperatures, approximations, and Mars a lot, alright?
\newcommand{\cotwo}{\hbox{CO$_{2}$ }}     % CO2
\newcommand{\degree}{^{\circ}}     % degrees
\newcommand{\simmod}{\raise.17ex\hbox{$\scriptstyle\sim$}}     % tilde
\newcolumntype{L}{>{\arraybackslash}m{2.6in}}
\newcolumntype{Q}{>{\centering\arraybackslash}m{0.25in}}
\newcolumntype{S}{>{\centering\arraybackslash}m{0.78in}}
\newcolumntype{T}{>{\centering\arraybackslash}m{0.5in}}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
\usepackage{lineno}

%% In order to have a caption to the side of a figure or table, use the
%% 'sidecap' package.
\usepackage[rightcaption]{sidecap}
\sidecaptionvpos{figure}{t}


%% For more control of the enumeration environment (lists with numbers)
%% use the enumitem package.
%\usepackage{enumitem}

%% Also, to reset the numbering of enumerate, use the following:
%\setenumerate[0]{label=\alph*.}

% To deal with figures all alone on a page.
\renewcommand{\floatpagefraction}{.8}%

% To use symbols for the footnotes:
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

\numberwithin{page}{section}
\renewcommand{\thepage}{\thesection-\arabic{page}}

% https://tex.stackexchange.com/questions/210871/latex-page-numbering-by-section
%this does not seem to work, just hard code it :(
% not sure if there is something else in this template that is breaking it
% or things have changed in the last 6 years?
%\usepackage{etoolbox}
%\makeatletter
%% Make sure that page starts from 1 with every \section
%\patchcmd{\@sect}% <cmd>
%  {\protected@edef}% <search>
%  {\def\arg{#1}\def\arg@{section}%
%   \ifx\arg\arg@\stepcounter{page}\fi%
%   \protected@edef}% <replace>
%  {}{}% <success><failure>
%\makeatother

%% Finally, we get to the document.
\begin{document}
\title{Improving the Foundations and Maintenance of Matplotlib and CartoPy}
\author{Dr. Thomas A Caswell\\Dr. Ryan May}
% This date field is blank becauseI usually don't put a date. It's not necessary and it's usually the wrong one.
\date{}
\maketitle

% First, let's get that TOC in there. NASA likes it.
%\renewcommand{\contentsname}{Science/Technical/Management}
\setcounter{tocdepth}{2}
\tableofcontents

\thispagestyle{empty}

% Let's leave this TOC alone on this page and start a new one for
% proposal body.
%\newpage

% Let's reset the page counter. This way the title/table-of-contents page is not included in the page numbering.

\newpage
\section{Scientific/Technical/Management (S/T/M)}
\setcounter{page}{1}
\subsection{description of software and relevance to SMD}
Matplotlib is an established open source plotting library with a
BSD-derived license that is currently used through out both the SMD
science community and the wider scientific community for both
publication quality figures and for interactive data exploration.  The
initial commits in our version history date to early 2003 and the
initial work was done in 2001-2002. Over the last 17 years the project
has grown to have over 1,000 individual contributors, over a million
users, and is in the top 100 most downloaded Python packages. We are a
dependency of many down-stream libraries, including yt, astropy,
ArviZ, and xarray. CartoPy is a Matplotlib extension library that
brings support for mapping applications to Matplotlib, providing
support for plotting using a variety of map projections (both
terrestrial and non) as well as providing out-of-the-box support for
many terrestrial map features. CartoPy is currently the only
Matplotlib-based plotting library for mapping applications being
actively developed in the Python ecosystem. CartoPy is frequently used
for earth science applications, including many uses of NASA Earth
science datasets.


\subsection{Objectives and Significance}
Matplotlib supports plotting unit-aware data structures which have
been used to support spaceflight operations by Monte, JPL's mission
design and navigation software system. Initial development of this
capability was supported by NASA. However, this support is under
documented making it difficult for users to understand how to fully
make use of the capability. Further, because we do not have full test
coverage of all plotting functions to verify that they correctly
handle units we have had a number of regressions in the
functionality. We will propose to write thorough user and technical
guides to working with unit-aware data in Matplotlib, add 100\% test
coverage of unit support in our plotting routines, and fix any issues
and inconsistencies discovered in this process.

CartoPy's mapping capabilities leverages the widely-used PROJ library
for mapping projections and the GEOS library for geometry
applications. Currently, CartoPy maintains custom code to interface
Python with these C-based libraries. As part of this work, we propose
porting Cartopy to instead use existing libraries that provide Python
bindings for these libraries, PyPROJ and PyGEOS. Not only will this
reduce CartoPy's overall amount of code and enhance maintainability,
but it will also address two of the biggest challenges that occur in
packaging CartoPy for its user-base.


Matplotlib and Cartopy are community-driven projects, but we have
grown to the point where we need developers with the time to organize,
plan, and make decisions. Issues and Pull Requests (PRs) are submitted
faster than our volunteers can review them;Matplotlib has accumulated
about 1300 open Issues and 300 open PRs due to this imbalance, while
CartoPy currently stands at 229 open issues and 40 open PRs. There may
be critical bug reports or insightful feature requests among the
former, while among the latter are useful contributions or bug fixes
that would improve the libraries for direct users and downstream
packages. The backlog is discouraging for new and occasional
contributors and distracting for core developers. The resources we
will request will help to significantly reduce, but not eliminate,
this backlog.

\subsection{Perceived impact of work}
\subsection{Relevance to program element}
\subsection{Technical approach and methodology}
\subsection{sources of uncertainty}
\subsection{mitigation to risk}
\subsection{roles of team members}
\subsection{workplan with milestones}

\subsection{Project Management}
\subsubsection{Governance}
\subsubsection{License}
\subsubsection{sustainability metrics}
\subsubsection{collaboration with related projects}
\subsubsection{inclusive practices}
\subsubsection{information dissemination}


\subsection{describe current workflow}

\newpage
\section{References}
\setcounter{page}{1}
% Here's how I get references.
\bibliography{mpl_cartopy.bib}

\newpage
\section{Data Management Plan}
\setcounter{page}{1}

Matplotlib is a software library and does not produce any scientific
data as defined in E.1.2 that needs to be preserved.

Matplotlib is currently developed in the open on GitHub and is
released under a permissive license (the Matplotlib license which is a
derivative of the PSF license and compatible with BSD-3).  All work
done on Matplotlib as part of this grant will be done through the
current workflow, will be publicly available, and released under the
same license.  Matplotlib uses git for version control, thus every
developer has the full history on their computer which provides
significant redundancy.  Tagged releases of the software are published
to pypi (in both source and binary forms).  In addition, Anaconada,
macports, homebrew, and all major Linux distributions independently
build, package, and host Matplotlib.

Cartopy is currently developed in the open on GitHub and is released
under the LGPL.  All work done on Matplotlib as part of this grant
will be done through the current workflow, will be publicly available,
and released under the same license. Cartopy uses git for version
control, thus every developer has the full history on their computer
which provides significant redundancy.

%do we need something about shape files / map tiles?


Any new libraries created as part of the ROSES award will be developed
in the open on GitHub and will released under a BSD-3 license.


% do we need this?
Any incidental work on other software packages, either upstream or
downstream of Matplotlib and Cartopy, will have to follow the license
and development of process of those projects, however precedence will
be given to OSS projects.


\newpage
\section{Biographical Sketches}
\setcounter{page}{1}
\newpage
\subsection{Principal Investigator}
\newpage
\subsection{Co-Investigator}

% This line gets the space in TOC right.
\addtocontents{toc}{\protect\vspace{12pt}}
\newpage
\section{Table of Personnel and Work Effort}
\setcounter{page}{1}

\newpage
\section{Current and Pending Support}
\setcounter{page}{1}

\newpage
\section{Budget Justification}
\setcounter{page}{1}

Due to being an established community driven project most regular
contributors have established and distinct primary institutions.  For
this reason significant portions of the budget will need to be
subcontracted to the primary institutions of key individuals who are
uniquely qualified for this work.

\newpage
\section{Facilities and Equipment}
\setcounter{page}{1}

None

\newpage
\section{Detailed Budget}
\setcounter{page}{1}



\end{document}
